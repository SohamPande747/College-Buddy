<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>College Buddy</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        margin: 0;
        padding: 50px;
        box-sizing: border-box;
        overflow: auto;
        height: 100vh;
        display: flex;
        flex-direction: column;
        align-items: center;
        background-image: url(6.png);
        align-items: center;
        image-rendering: optimizeSpeed;
      }
      .title {
        font-size: 100px;
        font-weight: bold;
        font-family: "Courier New", Courier, monospace;
        margin-bottom: 20px;
        color: #ffffff;
      }
      .description {
        font-size: 30px;
        font-weight: bold;
        font-family: cursive;
        margin-bottom: 50px;
        color: #ffffff;
      }
      .buttons-container {
        margin-bottom: 20px;
        flex-wrap: wrap;
        justify-content: center;
        display: grid;
        grid-template-columns: repeat(4, 1fr);
        grid-gap: 20px;
      }

      .button {
        display: inline-block;
        padding: 10px 20px;
        margin: 5px;
        background-color: #ffffff;
        color: rgb(0, 0, 0);
        border: none;
        cursor: pointer;
        border-radius: 5px;
        flex: 1 1 calc(33.333% - 10px);
        text-align: center;
      }
      .button:hover {
        background-color: #ffa852;
      }
      .code-container {
        display: none;
        width: 100%;
        max-width: 900px;
        margin-top: 20px;
        position: relative;
      }
      .code-container pre {
        background-color: #ffffff;
        padding: 20px;
        border: 1px solid #ddd;
        border-radius: 5px;
        position: relative;
        overflow-x: auto;
      }
      .copy-button {
        position: absolute;
        top: -10px;
        right: 0px;
        padding: 5px 5px;
        background-color: #006904;
        color: white;
        border: none;
        cursor: pointer;
        border-radius: 5px;
        margin-bottom: 50px;
      }
      .copy-button:hover {
        background-color: #218838;
      }
      .button-29 {
        align-items: center;
        appearance: none;
        background-image: radial-gradient(
          100% 100% at 100% 0,
          #5adaff 0,
          #5468ff 100%
        );
        border: 0;
        border-radius: 6px;
        box-shadow: rgba(45, 35, 66, 0.4) 0 2px 4px,
          rgba(45, 35, 66, 0.3) 0 7px 13px -3px,
          rgba(58, 65, 111, 0.5) 0 -3px 0 inset;
        box-sizing: border-box;
        color: #fff;
        cursor: pointer;
        display: inline-flex;
        font-family: "JetBrains Mono", monospace;
        height: 48px;
        justify-content: center;
        line-height: 1;
        list-style: none;
        overflow: hidden;
        padding-left: 16px;
        padding-right: 16px;
        position: relative;
        text-align: left;
        text-decoration: none;
        transition: box-shadow 0.15s, transform 0.15s;
        user-select: none;
        -webkit-user-select: none;
        touch-action: manipulation;
        white-space: nowrap;
        will-change: box-shadow, transform;
        font-size: 18px;
      }

      .button-29:focus {
        box-shadow: #3c4fe0 0 0 0 1.5px inset, rgba(45, 35, 66, 0.4) 0 2px 4px,
          rgba(45, 35, 66, 0.3) 0 7px 13px -3px, #3c4fe0 0 -3px 0 inset;
      }

      .button-29:hover {
        box-shadow: rgba(45, 35, 66, 0.4) 0 4px 8px,
          rgba(45, 35, 66, 0.3) 0 7px 13px -3px, #3c4fe0 0 -3px 0 inset;
        transform: translateY(-2px);
      }

      .button-29:active {
        box-shadow: #3c4fe0 0 3px 7px inset;
        transform: translateY(2px);
      }
    </style>
  </head>
  <body>
    <div class="title">College Buddy</div>
    <div class="description">
      These are some codes that I use in my day to day life as a college student
    </div>
    <div class="buttons-container">
      <button class="button-29" onclick="showCode('code1')">WEBM to MP3</button>
      <button class="button-29" onclick="showCode('code2')">
        Page Counter
      </button>
      <button class="button-29" onclick="showCode('code3')">PDF Merger</button>
      <button class="button-29" onclick="showCode('code4')">Word to PDF</button>
      <button class="button-29" onclick="showCode('code5')">PPT to PDF</button>
      <button class="button-29" onclick="showCode('code6')">
        YT Playlist Downloader
      </button>
      <button class="button-29" onclick="showCode('code7')">
        PDF Compressor
      </button>
      <button class="button-29" onclick="refreshPage()">Reload</button>
    </div>

    <div class="code-container" id="code-container">
      <button class="copy-button" onclick="copyCode()">Copy Code</button>
      <pre id="code"></pre>
    </div>

    <script>
      const scripts = {
        code1: `import os
from pydub import AudioSegment

def convert_to_mp3(input_file, output_file):
    # Load audio file
    audio = AudioSegment.from_file(input_file)
    
    # Export audio in MP3 format
    audio.export(output_file, format="mp3")
    print(f"Converted {input_file} to {output_file}")

def batch_convert_to_mp3(input_folder, output_folder):
    # Create output folder if it doesn't exist
    if not os.path.exists(output_folder):
        os.makedirs(output_folder)
    
    # Iterate through each file in the input folder
    for filename in os.listdir(input_folder):
        if filename.endswith(".webm"):  # Adjust the file extension
            input_file = os.path.join(input_folder, filename)
            output_file = os.path.join(output_folder, filename.replace(".webm", ".mp3")) # Change file extension
            convert_to_mp3(input_file, output_file)

# Example usage
input_folder = input("Enter folder: ")
output_folder = input("Enter folder: ")
batch_convert_to_mp3(input_folder, output_folder)`,

        code2: `import os
from PyPDF2 import PdfReader

def count_pages_in_pdf(file_path):
    try:
        with open(file_path, 'rb') as pdf_file:
            pdf_reader = PdfReader(pdf_file)
            return len(pdf_reader.pages)
    except Exception as e:
        print(f"Error reading {file_path}: {e}")
        return 0

def count_total_pages(pdf_files):
    total_pages = 0
    for pdf_file in pdf_files:
        total_pages += count_pages_in_pdf(pdf_file)
    return total_pages

def get_pdf_files_from_directory(directory):
    pdf_files = []
    for filename in os.listdir(directory):
        if filename.lower().endswith('.pdf'):
            pdf_files.append(os.path.join(directory, filename))
    return pdf_files

if __name__ == "__main__":
    directory = input("Enter the directory path containing PDF files: ")
    pdf_files = get_pdf_files_from_directory(directory)
    
    if not pdf_files:
        print("No PDF files found in the specified directory.")
    else:
        total_pages = count_total_pages(pdf_files)
        print(f"Total number of pages in all PDF files: {total_pages}")`,

        code3: `import PyPDF2
import tkinter as tk
from tkinter import filedialog
import os

def merge_pdfs(pdf_files, output_file):
    pdf_merger = PyPDF2.PdfMerger()

    for pdf_file in pdf_files:
        with open(pdf_file, 'rb') as file:
            pdf_merger.append(file)

    with open(output_file, 'wb') as output:
        pdf_merger.write(output)

    print("PDFs merged successfully into", output_file)

def select_files():
    root = tk.Tk()
    root.withdraw()
    file_paths = filedialog.askopenfilenames(filetypes=[("PDF files", "*.pdf")])
    return list(file_paths)

if __name__ == "__main__":
    pdf_files_to_merge = select_files()

    if len(pdf_files_to_merge) < 2:
        print("Error: You must select at least two PDF files to merge.")
    else:
        output_file = input("Enter the name of the output merged PDF file: ")
        if not output_file.endswith('.pdf'):
            output_file += '.pdf'
        merge_pdfs(pdf_files_to_merge, output_file)`,

        code4: `import os
from comtypes import client

def convert_doc_to_pdf(input_doc, output_pdf):
    word = client.CreateObject("Word.Application")
    word.Visible = True

    doc = word.Documents.Open(input_doc)
    doc.SaveAs(output_pdf, FileFormat=17)  # 17 represents PDF format
    doc.Close()

    word.Quit()

def batch_convert_docs_to_pdfs(input_folder, output_folder):
    if not os.path.exists(output_folder):
        os.makedirs(output_folder)

    for filename in os.listdir(input_folder):
        if filename.endswith(".docx") or filename.endswith(".doc"):
            input_path = os.path.join(input_folder, filename)
            output_path = os.path.join(output_folder, os.path.splitext(filename)[0] + ".pdf")
            convert_doc_to_pdf(input_path, output_path)

# Prompt the user to input the input and output folders
input_folder = input("Enter the input folder path: ")
output_folder = input("Enter the output folder path: ")

# Call the function to batch convert DOC to PDF
batch_convert_docs_to_pdfs(input_folder, output_folder)`,

        code5: `# script to convert ppt into pdf

import os
from comtypes import client


def convert_ppt_to_pdf(input_ppt, output_pdf):
    powerpoint = client.CreateObject("PowerPoint.Application")
    powerpoint.Visible = True

    ppt = powerpoint.Presentations.Open(input_ppt)
    ppt.SaveAs(output_pdf, 32)  # 32 represents PDF format
    ppt.Close()

    powerpoint.Quit()


def batch_convert_ppts_to_pdfs(input_folder, output_folder):
    if not os.path.exists(output_folder):
        os.makedirs(output_folder)

    for filename in os.listdir(input_folder):
        if filename.endswith(".pptx") or filename.endswith(".ppt"):
            input_path = os.path.join(input_folder, filename)
            output_path = os.path.join(output_folder, os.path.splitext(filename)[0] + ".pdf")
            convert_ppt_to_pdf(input_path, output_path)


# Prompt the user to input the input and output folders
input_folder = input("Enter the input folder path: ")
output_folder = input("Enter the output folder path: ")

# Call the function to batch convert PPT to PDF
batch_convert_ppts_to_pdfs(input_folder, output_folder)`,

        code6: `import yt_dlp

def download_playlist(playlist_url):
    try:
        options = {
            'format': 'bestaudio/best',
            'outtmpl': '%(title)s.%(ext)s',
            'merge_output_format': None,  # Skip merging
            'noplaylist': False,
        }

        with yt_dlp.YoutubeDL(options) as ydl:
            ydl.download([playlist_url])

        print("Download complete!")
    except yt_dlp.DownloadError as e:
        for err in e.exc_info:
            if isinstance(err, yt_dlp.utils.ExtractorError) and 'unavailable' in str(err):
                print("Skipped unavailable audio.")
            else:
                print(f"An error occurred: {err}")
                continue

# Replace 'YOUR_PLAYLIST_URL' with the actual URL of the playlist you want to download
playlist_url = input("Enter playlist url: ")
download_playlist(playlist_url)`,

        code7: `import tkinter as tk
from tkinter import filedialog
from PyPDF2 import PdfReader, PdfWriter
import os

def compress_pdf(input_path, output_path):
    with open(input_path, 'rb') as file:
        reader = PdfReader(file)
        writer = PdfWriter()

        for page in reader.pages:
            writer.add_page(page)

        with open(output_path, 'wb') as output_file:
            writer.write(output_file)

def select_input_file():
    input_file_path = filedialog.askopenfilename(filetypes=[("PDF files", "*.pdf")])
    input_file_entry.delete(0, tk.END)
    input_file_entry.insert(tk.END, input_file_path)
    set_default_output(input_file_path)

def set_default_output(input_file_path):
    output_directory = os.path.dirname(input_file_path)
    base_name = os.path.basename(input_file_path)
    output_file_path = os.path.join(output_directory, os.path.splitext(base_name)[0] + "_compressed.pdf")
    output_file_entry.delete(0, tk.END)
    output_file_entry.insert(tk.END, output_file_path)

def compress():
    input_path = input_file_entry.get()
    output_path = output_file_entry.get()

    if input_path and output_path:
        compress_pdf(input_path, output_path)
        status_label.config(text="PDF compression completed successfully.")
    else:
        status_label.config(text="Please select input file.")

# Create the main window
root = tk.Tk()
root.title("PDF Compressor")

# Create input file selection widgets
input_file_label = tk.Label(root, text="Select Input PDF File:")
input_file_label.grid(row=0, column=0, padx=5, pady=5)

input_file_entry = tk.Entry(root, width=50)
input_file_entry.grid(row=0, column=1, padx=5, pady=5)

input_file_button = tk.Button(root, text="Browse", command=select_input_file)
input_file_button.grid(row=0, column=2, padx=5, pady=5)

# Create output file entry widgets
output_file_label = tk.Label(root, text="Output PDF File:")
output_file_label.grid(row=1, column=0, padx=5, pady=5)

output_file_entry = tk.Entry(root, width=50)
output_file_entry.grid(row=1, column=1, padx=5, pady=5)

# Create compress button
compress_button = tk.Button(root, text="Compress PDF", command=compress)
compress_button.grid(row=2, column=1, padx=5, pady=10)

# Create status label
status_label = tk.Label(root, text="")
status_label.grid(row=3, column=1, padx=5, pady=5)

# Start the Tkinter event loop
root.mainloop()`,
      };

      function showCode(codeId) {
        document.getElementById("code").textContent = scripts[codeId];
        document.getElementById("code-container").style.display = "block";
      }

      function copyCode() {
        const codeElement = document.getElementById("code");
        const range = document.createRange();
        range.selectNode(codeElement);
        window.getSelection().removeAllRanges();
        window.getSelection().addRange(range);
        document.execCommand("copy");
        alert("Code copied to clipboard!");
      }
      function refreshPage() {
        location.reload();
      }
    </script>
  </body>
</html>
